- name: Configurar DNF para downloads mais rápidos
  become: true
  blockinfile:
    path: /etc/dnf/dnf.conf
    create: yes
    block: |
      # see `man dnf.conf` for defaults and possible options
      [main]
      fastestmirror=True
      max_parallel_downloads=10

- name: Instalar ferramentas de desenvolvimento do Fedora
  become: true
  dnf:
    name:
      - "@C Development Tools and Libraries"
      - "@Development Tools"
    state: present

- name: Baixar arquivo do repositório Topgrade
  become: true
  get_url:
    url: https://copr.fedorainfracloud.org/coprs/lilay/topgrade/repo/fedora-{{ ansible_facts.distribution_major_version }}/lilay-topgrade-fedora-{{ ansible_facts.distribution_major_version }}.repo
    dest: /etc/yum.repos.d/lilay-topgrade.repo
    mode: '0644'
    force: no

- name: Instalar Topgrade
  become: true
  dnf:
    name: topgrade
    state: present
